<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="420" viewBox="0 0 1200 420" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <style>
      .box { fill: #0f172a; stroke: #0ea5a4; stroke-width: 2; rx: 8; }
      .subbox { fill: #071127; stroke: #0ea5a4; stroke-width: 1.5; rx: 6; }
      .text { fill: #e6f4f3; font-family: Inter, Arial, sans-serif; font-size: 14px; }
      .title { font-size: 16px; font-weight: 700; }
      .arrow { stroke: #94a3b8; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8" />
    </marker>
  </defs>

  <!-- Browser -->
  <rect x="36" y="36" width="260" height="110" class="box"/>
  <text x="56" y="64" class="text title">Browser</text>
  <text x="56" y="90" class="text">- Client Components</text>
  <text x="56" y="110" class="text">- useRealTimeChat / UI</text>

  <!-- Next.js Server -->
  <rect x="420" y="20" width="360" height="150" class="box"/>
  <text x="440" y="48" class="text title">Next.js (Server)</text>
  <text x="440" y="76" class="text">- Server Components</text>
  <text x="440" y="96" class="text">- Server Actions (sendMessage, createRoom)</text>
  <text x="440" y="116" class="text">- SSR helpers (getCurrentUser, getPublicRooms)</text>

  <!-- Supabase cluster -->
  <rect x="860" y="36" width="300" height="250" rx="10" ry="10" fill="#001f2d" stroke="#06b6d4" stroke-width="2" />
  <text x="880" y="64" class="text title">Supabase</text>

  <!-- Subcomponents inside Supabase -->
  <rect x="880" y="90" width="260" height="56" class="subbox"/>
  <text x="900" y="126" class="text">Auth</text>

  <rect x="880" y="156" width="260" height="56" class="subbox"/>
  <text x="900" y="192" class="text">Realtime (Channels)</text>

  <rect x="880" y="222" width="260" height="56" class="subbox"/>
  <text x="900" y="258" class="text">Postgres (messages, rooms)</text>

  <!-- Arrows -->
  <path d="M296 92 L420 92" class="arrow" />
  <path d="M780 92 L860 92" class="arrow" />

  <!-- Realtime arrow (bi-directional hint) -->
  <path d="M660 180 L820 180" stroke="#f59e0b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M820 200 L660 200" stroke="#f59e0b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="680" y="170" class="text">Realtime Channel (broadcast / presence)</text>

  <!-- Notes -->
  <text x="56" y="170" class="text">Flow:</text>
  <text x="56" y="190" class="text">1) Server Components fetch initial data → pass to Client</text>
  <text x="56" y="210" class="text">2) Client opens Realtime channel → receive live messages</text>
  <text x="56" y="230" class="text">3) sendMessage via Server Action → DB insert → broadcast</text>

</svg>
